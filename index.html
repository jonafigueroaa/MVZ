<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Malla Curricular Veterinaria</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f2f2f2;
      margin: 0;
      padding: 20px;
    }
    h2 {
      color: #333;
    }
    .year {
      margin-bottom: 30px;
    }
    .cycle {
      background-color: #ffffff;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      margin-top: 10px;
      margin-bottom: 10px;
    }
    .subject {
      padding: 8px 12px;
      border: 1px solid #ccc;
      border-radius: 5px;
      margin: 5px 0;
      background-color: #e9ecef;
      cursor: pointer;
      transition: background-color 0.3s ease;
      position: relative;
    }
    .subject.approved {
      background-color: #b2f2bb;
      text-decoration: line-through;
    }
    .subject.locked {
      background-color: #f8d7da;
      cursor: not-allowed;
    }
    .tooltip {
      visibility: hidden;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 4px;
      padding: 4px 8px;
      position: absolute;
      z-index: 1;
      top: 100%;
      left: 0;
      transform: translateY(4px);
      font-size: 12px;
      white-space: nowrap;
    }
    .subject:hover .tooltip {
      visibility: visible;
    }
  </style>
</head>
<body>
  <h1>Malla Curricular - Medicina Veterinaria y Zootecnia</h1>
  <div id="malla"></div>

  <script>
    const data = [
      {
        year: "Primer Año",
        cycles: [
          {
            name: "Ciclo I",
            subjects: [
              "Matematica",
              "Filosofia General",
              "Sociologia General",
              "Quimica General",
              "Zootecnia General"
            ]
          },
          {
            name: "Ciclo II",
            subjects: [
              { name: "Animales y Su Ambiente" },
              { name: "Bioestadistica", reqs: ["Matematica"] },
              { name: "Biofisica", reqs: ["Matematica"] },
              { name: "Biologia Molecular de la Celula", reqs: ["Quimica General"] },
              { name: "Quimica Organica", reqs: ["Quimica General"] }
            ]
          }
        ]
      },
      {
        year: "Segundo Año",
        cycles: [
          {
            name: "Ciclo III",
            subjects: [
              { name: "Anatomia Descriptiva y Diseccion I", reqs: ["Biologia Molecular de la Celula"] },
              { name: "Bioquimica", reqs: ["Quimica Organica"] },
              "Ingles I",
              "Metodos de Investigacion e Informatica",
              { name: "Microbiologia General", reqs: ["Biologia Molecular de la Celula"] }
            ]
          },
          {
            name: "Ciclo IV",
            subjects: [
              { name: "Anatomia Descriptiva y Diseccion II", reqs: ["Anatomia Descriptiva y Diseccion I"] },
              { name: "Bacteriologia y Micologia", reqs: ["Microbiologia General"] },
              { name: "Ingles II", reqs: ["Ingles I"] },
              { name: "Parasitologia", reqs: ["Microbiologia General"] },
              { name: "Pastos y Forrajes", reqs: ["Animales y Su Ambiente"] }
            ]
          }
        ]
      },
{
        year: "Tercer Año",
        cycles: [
          {
            name: "Ciclo V",
            subjects: [
              { name: "Anatomia Topografica", reqs: ["Anatomia Descriptiva y Diseccion II"] },
              { name: "Enfermedades Parasitarias", reqs: ["Parasitologia"] },
              { name: "Fisiologia General", reqs: ["Bioquimica"] },
              { name: "Histologia y Embriologia Comparada", reqs: ["Anatomia Descriptiva y Diseccion II"] },
              { name: "Ingles III", reqs: ["Ingles II"] },
              { name: "Virologia", reqs: ["Microbiologia General"] }
            ]
          },
          {
            name: "Ciclo VI",
            subjects: [
              { name: "Fisiologia Especial", reqs: ["Fisiologia General"] },
              { name: "Ingles IV", reqs: ["Ingles III"] },
              { name: "Inmunologia", reqs: ["Virologia"] },
              { name: "Higiene y Profilaxis Animal", reqs: ["Bacteriologia y Micologia", "Virologia"] },
              { name: "Propedeutica Tecnica", reqs: ["Fisiologia General"] },
              { name: "Zootecnia de Pequeñas Especies", reqs: ["Zootecnia General", "Anatomia Topografica"] }
            ]
          }
        ]
      },
      {
        year: "Cuarto Año",
        cycles: [
          {
            name: "Ciclo VII",
            subjects: [
              { name: "Alimentos y Nutricion", reqs: ["Fisiologia Especial"] },
              { name: "Farmacologia General", reqs: ["Fisiologia Especial", "Propedeutica Tecnica"] },
              { name: "Imagenologia", reqs: ["Anatomia Topografica"] },
              { name: "Produccion de pequeños rumiantes", reqs: ["Higiene y Profilaxis Animal"] },
              { name: "Economía Y Administración De Empresas Agropecuarias", reqs: ["Higiene y Profilaxis Animal"] },
              { name: "Patologia General", reqs: ["Fisiologia Especial"] }
            ]
          },
          {
            name: "Ciclo VIII",
            subjects: [
              { name: "Tecnicas Quirurgicas", reqs: ["Imagenologia", "Farmacologia General"] },
              { name: "Laboratorio Clinico", reqs: ["Enfermedades Parasitarias", "Fisiologia Especial"] },
              { name: "Farmacologia Especial", reqs: ["Farmacologia General"] },
              { name: "Patologia Sistemica I", reqs: ["Patologia General"] },
              { name: "Seminario de Investigacion", reqs: ["Metodos de Investigacion e Informatica"] }
            ]
          }
        ]
      }
    ];

    // Carga aprobados o vacío
    const approved = JSON.parse(localStorage.getItem("approvedSubjects") || "[]");

    function saveProgress() {
      localStorage.setItem("approvedSubjects", JSON.stringify(approved));
    }

    function createSubjectElement(subject) {
      const isObject = typeof subject === "object";
      const name = isObject ? subject.name : subject;
      const reqs = isObject && Array.isArray(subject.reqs) ? subject.reqs : [];

      const el = document.createElement("div");
      el.className = "subject";
      el.textContent = name;

      const tooltip = document.createElement("span");
      tooltip.className = "tooltip";
      el.appendChild(tooltip);

      const isApproved = approved.includes(name);
      const unmetReqs = reqs.filter(req => !approved.includes(req));

      if (isApproved) {
        el.classList.add("approved");
      } else if (unmetReqs.length > 0) {
        el.classList.add("locked");
        tooltip.textContent = `Requiere: ${unmetReqs.join(", ")}`;
      }

      el.addEventListener("click", () => {
        if (el.classList.contains("locked")) return;
        if (el.classList.contains("approved")) {
          const idx = approved.indexOf(name);
          if (idx > -1) approved.splice(idx, 1);
          el.classList.remove("approved");
        } else {
          approved.push(name);
          el.classList.add("approved");
        }
        saveProgress();
        render();
      });

      return el;
    }

    function render() {
      const container = document.getElementById("malla");
      container.innerHTML = "";
      data.forEach(year => {
        const yearDiv = document.createElement("div");
        yearDiv.className = "year";

        const yearTitle = document.createElement("h2");
        yearTitle.textContent = year.year;
        yearDiv.appendChild(yearTitle);

        year.cycles.forEach(cycle => {
          const cycleDiv = document.createElement("div");
          cycleDiv.className = "cycle";

          const cycleTitle = document.createElement("h3");
          cycleTitle.textContent = cycle.name;
          cycleDiv.appendChild(cycleTitle);

          cycle.subjects.forEach(subject => {
            cycleDiv.appendChild(createSubjectElement(subject));
          });

          yearDiv.appendChild(cycleDiv);
        });

        container.appendChild(yearDiv);
      });
    }

    render();
  </script>
</body>
</html>
